<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ditabung Yokk</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#fff;
  padding:15px;
}

/* LOGO */
.logo{
  text-align:center;
  margin-bottom:15px;
}
.logo img{
  max-width:100%;
  height:auto;
}

/* TOMBOL */
.controls{
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  margin-bottom:10px;
}
button{
  background:#ff8fa3;
  color:white;
  border:none;
  padding:6px 10px;
  border-radius:4px;
  cursor:pointer;
  font-size:12px;
}
button:hover{opacity:0.9}

/* TABEL */
table{
  width:100%;
  border-collapse:separate;
  border-spacing:5px;
}
th{
  background:#ff9aa2;
  color:white;
  font-size:12px;
  padding:6px;
}
td{
  background:#ffe3e8;
  border:1px dashed #ff9aa2;
  padding:4px;
  text-align:center;
}
input{
  width:100%;
  border:none;
  background:transparent;
  text-align:center;
  outline:none;
}
.action{
  background:#ff6b6b;
  color:white;
}
</style>
</head>

<body>

<!-- LOGO -->
<div class="logo">
  <!-- GANTI src DENGAN LOGO KAMU -->
  <img src="logo.png" alt="Logo">
</div>

<!-- TOMBOL -->
<div class="controls">
  <button onclick="addRow()">Tambah Data</button>
  <button onclick="resetData()">Reset Semua</button>
  <button onclick="downloadTXT()">TXT</button>
  <button onclick="downloadPDF()">PDF</button>
  <button onclick="downloadWORD()">WORD</button>
  <button onclick="downloadEXCEL()">EXCEL</button>
</div>

<!-- TABEL -->
<table id="table">
<thead>
<tr>
  <th>No</th>
  <th>Tanggal</th>
  <th>Penanggung Jawab</th>
  <th>Keterangan</th>
  <th>Pemasukan (Rp)</th>
  <th>Pengeluaran (Rp)</th>
  <th>Profit</th>
  <th>Total</th>
  <th>Aksi</th>
</tr>
</thead>
<tbody></tbody>
</table>

<script>
let data = JSON.parse(localStorage.getItem("ditabung")) || [];

function formatRupiah(n){
  return "Rp " + (n||0).toLocaleString("id-ID");
}

function render(){
  const tbody=document.querySelector("tbody");
  tbody.innerHTML="";
  let total=0;

  data.forEach((d,i)=>{
    const profit=d.in-d.out;
    total+=profit;

    tbody.innerHTML+=`
    <tr>
      <td>${i+1}</td>
      <td><input value="${d.date}" onchange="edit(${i},'date',this.value)"></td>
      <td><input value="${d.pic}" onchange="edit(${i},'pic',this.value)"></td>
      <td><input value="${d.note}" onchange="edit(${i},'note',this.value)"></td>
      <td><input type="number" value="${d.in}" onchange="edit(${i},'in',this.value)"></td>
      <td><input type="number" value="${d.out}" onchange="edit(${i},'out',this.value)"></td>
      <td>${formatRupiah(profit)}</td>
      <td>${formatRupiah(total)}</td>
      <td><button class="action" onclick="hapus(${i})">X</button></td>
    </tr>`;
  });

  localStorage.setItem("ditabung",JSON.stringify(data));
}

function addRow(){
  data.push({date:"",pic:"",note:"",in:0,out:0});
  render();
}

function edit(i,k,v){
  data[i][k]=k=="in"||k=="out"?Number(v):v;
  render();
}

function hapus(i){
  data.splice(i,1);
  render();
}

function resetData(){
  if(confirm("Hapus semua data?")){
    data=[];
    render();
  }
}

/* DOWNLOAD */
function downloadTXT(){
  let t="Ditabung Yokk\n\n";
  data.forEach((d,i)=>{
    t+=`${i+1}. ${d.date} | ${d.pic} | ${d.note} | +${d.in} -${d.out}\n`;
  });
  saveFile(t,"laporan.txt","text/plain");
}

function downloadWORD(){
  let html="<h2>Laporan Ditabung</h2><table border='1'><tr><th>No</th><th>Tanggal</th><th>PJ</th><th>Ket</th><th>Masuk</th><th>Keluar</th></tr>";
  data.forEach((d,i)=>{
    html+=`<tr><td>${i+1}</td><td>${d.date}</td><td>${d.pic}</td><td>${d.note}</td><td>${d.in}</td><td>${d.out}</td></tr>`;
  });
  html+="</table>";
  saveFile(html,"laporan.doc","application/msword");
}

function downloadEXCEL(){
  let csv="No,Tanggal,PJ,Keterangan,Pemasukan,Pengeluaran\n";
  data.forEach((d,i)=>{
    csv+=`${i+1},${d.date},${d.pic},${d.note},${d.in},${d.out}\n`;
  });
  saveFile(csv,"laporan.xls","application/vnd.ms-excel");
}

function downloadPDF(){
  window.print();
}

function saveFile(content,name,type){
  const a=document.createElement("a");
  a.href=URL.createObjectURL(new Blob([content],{type:type}));
  a.download=name;
  a.click();
}

render();
</script>

</body>
</html>

